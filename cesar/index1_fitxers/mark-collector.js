var MarkCollector=function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=Math.ceil,i=Math.floor,a=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)},r=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e},o=t(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),c=t(function(e){var t=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=t)}),l=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},u=function(e,t,n){if(l(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,a){return e.call(t,n,i,a)}}return function(){return e.apply(t,arguments)}},s=function(e){return"object"==typeof e?null!==e:"function"==typeof e},d=function(e){if(!s(e))throw TypeError(e+" is not an object!");return e},v=function(e){try{return!!e()}catch(e){return!0}},p=!v(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),f=o.document,g=s(f)&&s(f.createElement),y=function(e){return g?f.createElement(e):{}},h=!p&&!v(function(){return 7!=Object.defineProperty(y("div"),"a",{get:function(){return 7}}).a}),m=Object.defineProperty,T={f:p?Object.defineProperty:function(e,t,n){if(d(e),t=function(e,t){if(!s(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!s(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!s(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!s(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}(t,!0),d(n),h)try{return m(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},A=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},w=p?function(e,t,n){return T.f(e,t,A(1,n))}:function(e,t,n){return e[t]=n,e},k={}.hasOwnProperty,N=function(e,t){return k.call(e,t)},I=function(e,t,n){var i,a,r,l=e&I.F,s=e&I.G,d=e&I.S,v=e&I.P,p=e&I.B,f=e&I.W,g=s?c:c[t]||(c[t]={}),y=g.prototype,h=s?o:d?o[t]:(o[t]||{}).prototype;for(i in s&&(n=t),n)(a=!l&&h&&void 0!==h[i])&&N(g,i)||(r=a?h[i]:n[i],g[i]=s&&"function"!=typeof h[i]?n[i]:p&&a?u(r,o):f&&h[i]==r?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(r):v&&"function"==typeof r?u(Function.call,r):r,v&&((g.virtual||(g.virtual={}))[i]=r,e&I.R&&y&&!y[i]&&w(y,i,r)))};I.F=1,I.G=2,I.S=4,I.P=8,I.B=16,I.W=32,I.U=64,I.R=128;var S,M=I,b=w,_={},C={}.toString,E=function(e){return C.call(e).slice(8,-1)},P=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==E(e)?e.split(""):Object(e)},x=function(e){return P(r(e))},O=Math.min,D=function(e){return e>0?O(a(e),9007199254740991):0},V=Math.max,j=Math.min,R=o["__core-js_shared__"]||(o["__core-js_shared__"]={}),L=function(e){return R[e]||(R[e]={})},F=0,U=Math.random(),H=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++F+U).toString(36))},G=L("keys"),B=function(e){return G[e]||(G[e]=H(e))},q=(S=!1,function(e,t,n){var i,r=x(e),o=D(r.length),c=function(e,t){return(e=a(e))<0?V(e+t,0):j(e,t)}(n,o);if(S&&t!=t){for(;o>c;)if((i=r[c++])!=i)return!0}else for(;o>c;c++)if((S||c in r)&&r[c]===t)return S||c||0;return!S&&-1}),Y=B("IE_PROTO"),z="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),W=Object.keys||function(e){return function(e,t){var n,i=x(e),a=0,r=[];for(n in i)n!=Y&&N(i,n)&&r.push(n);for(;t.length>a;)N(i,n=t[a++])&&(~q(r,n)||r.push(n));return r}(e,z)},J=p?Object.defineProperties:function(e,t){d(e);for(var n,i=W(t),a=i.length,r=0;a>r;)T.f(e,n=i[r++],t[n]);return e},K=o.document,X=K&&K.documentElement,Q=B("IE_PROTO"),Z=function(){},$=function(){var e,t=y("iframe"),n=z.length;for(t.style.display="none",X.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),$=e.F;n--;)delete $.prototype[z[n]];return $()},ee=Object.create||function(e,t){var n;return null!==e?(Z.prototype=d(e),n=new Z,Z.prototype=null,n[Q]=e):n=$(),void 0===t?n:J(n,t)},te=t(function(e){var t=L("wks"),n=o.Symbol,i="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=i&&n[e]||(i?n:H)("Symbol."+e))}).store=t}),ne=T.f,ie=te("toStringTag"),ae=function(e,t,n){e&&!N(e=n?e:e.prototype,ie)&&ne(e,ie,{configurable:!0,value:t})},re={};w(re,te("iterator"),function(){return this});var oe,ce=function(e,t,n){e.prototype=ee(re,{next:A(1,n)}),ae(e,t+" Iterator")},le=function(e){return Object(r(e))},ue=B("IE_PROTO"),se=Object.prototype,de=Object.getPrototypeOf||function(e){return e=le(e),N(e,ue)?e[ue]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?se:null},ve=te("iterator"),pe=!([].keys&&"next"in[].keys()),fe=function(){return this},ge=function(e,t,n,i,a,r,o){ce(n,t,i);var c,l,u,s=function(e){if(!pe&&e in f)return f[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},d=t+" Iterator",v="values"==a,p=!1,f=e.prototype,g=f[ve]||f["@@iterator"]||a&&f[a],y=g||s(a),h=a?v?s("entries"):y:void 0,m="Array"==t&&f.entries||g;if(m&&(u=de(m.call(new e)))!==Object.prototype&&u.next&&ae(u,d,!0),v&&g&&"values"!==g.name&&(p=!0,y=function(){return g.call(this)}),o&&(pe||p||!f[ve])&&w(f,ve,y),_[t]=y,_[d]=fe,a)if(c={values:v?y:s("values"),keys:r?y:s("keys"),entries:h},o)for(l in c)l in f||b(f,l,c[l]);else M(M.P+M.F*(pe||p),t,c);return c},ye=(oe=!0,function(e,t){var n,i,o=String(r(e)),c=a(t),l=o.length;return c<0||c>=l?oe?"":void 0:(n=o.charCodeAt(c))<55296||n>56319||c+1===l||(i=o.charCodeAt(c+1))<56320||i>57343?oe?o.charAt(c):n:oe?o.slice(c,c+2):i-56320+(n-55296<<10)+65536});ge(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=ye(t,n),this._i+=e.length,{value:e,done:!1})});var he=function(e,t){return{value:t,done:!!e}};ge(Array,"Array",function(e,t){this._t=x(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,he(1)):he(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values");_.Arguments=_.Array;for(var me=te("toStringTag"),Te="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ae=0;Ae<Te.length;Ae++){var we=Te[Ae],ke=o[we],Ne=ke&&ke.prototype;Ne&&!Ne[me]&&w(Ne,me,we),_[we]=_.Array}var Ie,Se,Me,be,_e,Ce,Ee,Pe,xe,Oe=function(e,t,n){for(var i in t)n&&e[i]?e[i]=t[i]:w(e,i,t[i]);return e},De=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e},Ve=function(e,t,n,i){try{return i?t(d(n)[0],n[1]):t(n)}catch(t){var a=e.return;throw void 0!==a&&d(a.call(e)),t}},je=te("iterator"),Re=Array.prototype,Le=te("toStringTag"),Fe="Arguments"==E(function(){return arguments}()),Ue=function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Le))?n:Fe?E(t):"Object"==(i=E(t))&&"function"==typeof t.callee?"Arguments":i},He=te("iterator"),Ge=c.getIteratorMethod=function(e){if(void 0!=e)return e[He]||e["@@iterator"]||_[Ue(e)]},Be=t(function(e){var t={},n={},i=e.exports=function(e,i,a,r,o){var c,l,s,v,p,f=o?function(){return e}:Ge(e),g=u(a,r,i?2:1),y=0;if("function"!=typeof f)throw TypeError(e+" is not iterable!");if(void 0===(p=f)||_.Array!==p&&Re[je]!==p){for(s=f.call(e);!(l=s.next()).done;)if((v=Ve(s,g,l.value,i))===t||v===n)return v}else for(c=D(e.length);c>y;y++)if((v=i?g(d(l=e[y])[0],l[1]):g(e[y]))===t||v===n)return v};i.BREAK=t,i.RETURN=n}),qe=te("species"),Ye=function(e){var t="function"==typeof c[e]?c[e]:o[e];p&&t&&!t[qe]&&T.f(t,qe,{configurable:!0,get:function(){return this}})},ze=t(function(e){var t=H("meta"),n=T.f,i=0,a=Object.isExtensible||function(){return!0},r=!v(function(){return a(Object.preventExtensions({}))}),o=function(e){n(e,t,{value:{i:"O"+ ++i,w:{}}})},c=e.exports={KEY:t,NEED:!1,fastKey:function(e,n){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!N(e,t)){if(!a(e))return"F";if(!n)return"E";o(e)}return e[t].i},getWeak:function(e,n){if(!N(e,t)){if(!a(e))return!0;if(!n)return!1;o(e)}return e[t].w},onFreeze:function(e){return r&&c.NEED&&a(e)&&!N(e,t)&&o(e),e}}}),We=function(e,t){if(!s(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},Je=T.f,Ke=ze.fastKey,Xe=p?"_s":"size",Qe=function(e,t){var n,i=Ke(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n},Ze={getConstructor:function(e,t,n,i){var a=e(function(e,r){De(e,a,t,"_i"),e._t=t,e._i=ee(null),e._f=void 0,e._l=void 0,e[Xe]=0,void 0!=r&&Be(r,n,e[i],e)});return Oe(a.prototype,{clear:function(){for(var e=We(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[Xe]=0},delete:function(e){var n=We(this,t),i=Qe(n,e);if(i){var a=i.n,r=i.p;delete n._i[i.i],i.r=!0,r&&(r.n=a),a&&(a.p=r),n._f==i&&(n._f=a),n._l==i&&(n._l=r),n[Xe]--}return!!i},forEach:function(e){We(this,t);for(var n,i=u(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!Qe(We(this,t),e)}}),p&&Je(a.prototype,"size",{get:function(){return We(this,t)[Xe]}}),a},def:function(e,t,n){var i,a,r=Qe(e,t);return r?r.v=n:(e._l=r={i:a=Ke(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=r),i&&(i.n=r),e[Xe]++,"F"!==a&&(e._i[a]=r)),e},getEntry:Qe,setStrong:function(e,t,n){ge(e,t,function(e,n){this._t=We(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?he(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,he(1))},n?"entries":"values",!n,!0),Ye(t)}},$e=Array.isArray||function(e){return"Array"==E(e)},et=te("species"),tt=function(e,t){return new(function(e){var t;return $e(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!$e(t.prototype)||(t=void 0),s(t)&&null===(t=t[et])&&(t=void 0)),void 0===t?Array:t}(e))(t)},nt=T.f,it=(Me=1==(Ie=0),be=2==Ie,_e=3==Ie,Ce=4==Ie,Ee=6==Ie,Pe=5==Ie||Ee,xe=Se||tt,function(e,t,n){for(var i,a,r=le(e),o=P(r),c=u(t,n,3),l=D(o.length),s=0,d=Me?xe(e,l):be?xe(e,0):void 0;l>s;s++)if((Pe||s in o)&&(a=c(i=o[s],s,r),Ie))if(Me)d[s]=a;else if(a)switch(Ie){case 3:return!0;case 5:return i;case 6:return s;case 2:d.push(i)}else if(Ce)return!1;return Ee?-1:_e||Ce?Ce:d});!function(e,t,n,i,a,r){var c=o[e],l=c,u=a?"set":"add",d=l&&l.prototype,f={};p&&"function"==typeof l&&(r||d.forEach&&!v(function(){(new l).entries().next()}))?(l=t(function(t,n){De(t,l,e,"_c"),t._c=new c,void 0!=n&&Be(n,a,t[u],t)}),it("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in d&&(!r||"clear"!=e)&&w(l.prototype,e,function(n,i){if(De(this,l,e),!t&&r&&!s(n))return"get"==e&&void 0;var a=this._c[e](0===n?0:n,i);return t?this:a})}),r||nt(l.prototype,"size",{get:function(){return this._c.size}})):(l=i.getConstructor(t,e,a,u),Oe(l.prototype,n),ze.NEED=!0),ae(l,e),f[e]=l,M(M.G+M.W+M.F,f),r||i.setStrong(l,e,a)}("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=Ze.getEntry(We(this,"Map"),e);return t&&t.v},set:function(e,t){return Ze.def(We(this,"Map"),0===e?0:e,t)}},Ze,!0);M(M.P+M.R,"Map",{toJSON:function(e){return function(){if(Ue(this)!=e)throw TypeError(e+"#toJSON isn't generic");return Be(this,!1,(n=[]).push,n,t),n;var t,n}}("Map")});var at;at="Map",M(M.S,at,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}});!function(e){M(M.S,e,{from:function(e){var t,n,i,a,r=arguments[1];return l(this),(t=void 0!==r)&&l(r),void 0==e?new this:(n=[],t?(i=0,a=u(r,arguments[2],2),Be(e,!1,function(e){n.push(a(e,i++))})):Be(e,!1,n.push,n),new this(n))}})}("Map");var rt,ot,ct,lt=c.Map,ut=e(t(function(e){e.exports={default:lt,__esModule:!0}})),st=te("species"),dt=function(e,t){var n,i=d(e).constructor;return void 0===i||void 0==(n=d(i)[st])?t:l(n)},vt=o.process,pt=o.setImmediate,ft=o.clearImmediate,gt=o.MessageChannel,yt=o.Dispatch,ht=0,mt={},Tt=function(){var e=+this;if(mt.hasOwnProperty(e)){var t=mt[e];delete mt[e],t()}},At=function(e){Tt.call(e.data)};pt&&ft||(pt=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return mt[++ht]=function(){!function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}e.apply(n,t)}("function"==typeof e?e:Function(e),t)},rt(ht),ht},ft=function(e){delete mt[e]},"process"==E(vt)?rt=function(e){vt.nextTick(u(Tt,e,1))}:yt&&yt.now?rt=function(e){yt.now(u(Tt,e,1))}:gt?(ct=(ot=new gt).port2,ot.port1.onmessage=At,rt=u(ct.postMessage,ct,1)):o.addEventListener&&"function"==typeof postMessage&&!o.importScripts?(rt=function(e){o.postMessage(e+"","*")},o.addEventListener("message",At,!1)):rt="onreadystatechange"in y("script")?function(e){X.appendChild(y("script")).onreadystatechange=function(){X.removeChild(this),Tt.call(e)}}:function(e){setTimeout(u(Tt,e,1),0)});var wt={set:pt,clear:ft},kt=wt.set,Nt=o.MutationObserver||o.WebKitMutationObserver,It=o.process,St=o.Promise,Mt="process"==E(It);var bt={f:function(e){return new function(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=l(t),this.reject=l(n)}(e)}},_t=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},Ct=function(e,t){if(d(e),s(t)&&t.constructor===e)return t;var n=bt.f(e);return(0,n.resolve)(t),n.promise},Et=te("iterator"),Pt=!1;try{var xt=[7][Et]();xt.return=function(){Pt=!0},Array.from(xt,function(){throw 2})}catch(e){}var Ot,Dt,Vt,jt,Rt=wt.set,Lt=function(){var e,t,n,i=function(){var i,a;for(Mt&&(i=It.domain)&&i.exit();e;){a=e.fn,e=e.next;try{a()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(Mt)n=function(){It.nextTick(i)};else if(!Nt||o.navigator&&o.navigator.standalone)if(St&&St.resolve){var a=St.resolve();n=function(){a.then(i)}}else n=function(){kt.call(o,i)};else{var r=!0,c=document.createTextNode("");new Nt(i).observe(c,{characterData:!0}),n=function(){c.data=r=!r}}return function(i){var a={fn:i,next:void 0};t&&(t.next=a),e||(e=a,n()),t=a}}(),Ft=o.TypeError,Ut=o.process,Ht=o.Promise,Gt="process"==Ue(Ut),Bt=function(){},qt=Dt=bt.f,Yt=!!function(){try{var e=Ht.resolve(1),t=(e.constructor={})[te("species")]=function(e){e(Bt,Bt)};return(Gt||"function"==typeof PromiseRejectionEvent)&&e.then(Bt)instanceof t}catch(e){}}(),zt=function(e){var t;return!(!s(e)||"function"!=typeof(t=e.then))&&t},Wt=function(e,t){if(!e._n){e._n=!0;var n=e._c;Lt(function(){for(var i=e._v,a=1==e._s,r=0,o=function(t){var n,r,o,c=a?t.ok:t.fail,l=t.resolve,u=t.reject,s=t.domain;try{c?(a||(2==e._h&&Xt(e),e._h=1),!0===c?n=i:(s&&s.enter(),n=c(i),s&&(s.exit(),o=!0)),n===t.promise?u(Ft("Promise-chain cycle")):(r=zt(n))?r.call(n,l,u):l(n)):u(i)}catch(e){s&&!o&&s.exit(),u(e)}};n.length>r;)o(n[r++]);e._c=[],e._n=!1,t&&!e._h&&Jt(e)})}},Jt=function(e){Rt.call(o,function(){var t,n,i,a=e._v,r=Kt(e);if(r&&(t=_t(function(){Gt?Ut.emit("unhandledRejection",a,e):(n=o.onunhandledrejection)?n({promise:e,reason:a}):(i=o.console)&&i.error&&i.error("Unhandled promise rejection",a)}),e._h=Gt||Kt(e)?2:1),e._a=void 0,r&&t.e)throw t.v})},Kt=function(e){return 1!==e._h&&0===(e._a||e._c).length},Xt=function(e){Rt.call(o,function(){var t;Gt?Ut.emit("rejectionHandled",e):(t=o.onrejectionhandled)&&t({promise:e,reason:e._v})})},Qt=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),Wt(t,!0))},Zt=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw Ft("Promise can't be resolved itself");(t=zt(e))?Lt(function(){var i={_w:n,_d:!1};try{t.call(e,u(Zt,i,1),u(Qt,i,1))}catch(e){Qt.call(i,e)}}):(n._v=e,n._s=1,Wt(n,!1))}catch(e){Qt.call({_w:n,_d:!1},e)}}};Yt||(Ht=function(e){De(this,Ht,"Promise","_h"),l(e),Ot.call(this);try{e(u(Zt,this,1),u(Qt,this,1))}catch(e){Qt.call(this,e)}},(Ot=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Oe(Ht.prototype,{then:function(e,t){var n=qt(dt(this,Ht));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=Gt?Ut.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Wt(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),Vt=function(){var e=new Ot;this.promise=e,this.resolve=u(Zt,e,1),this.reject=u(Qt,e,1)},bt.f=qt=function(e){return e===Ht||e===jt?new Vt(e):Dt(e)}),M(M.G+M.W+M.F*!Yt,{Promise:Ht}),ae(Ht,"Promise"),Ye("Promise"),jt=c.Promise,M(M.S+M.F*!Yt,"Promise",{reject:function(e){var t=qt(this);return(0,t.reject)(e),t.promise}}),M(M.S+!0*M.F,"Promise",{resolve:function(e){return Ct(this===jt?Ht:this,e)}}),M(M.S+M.F*!(Yt&&function(e,t){if(!t&&!Pt)return!1;var n=!1;try{var i=[7],a=i[Et]();a.next=function(){return{done:n=!0}},i[Et]=function(){return a},e(i)}catch(e){}return n}(function(e){Ht.all(e).catch(Bt)})),"Promise",{all:function(e){var t=this,n=qt(t),i=n.resolve,a=n.reject,r=_t(function(){var n=[],r=0,o=1;Be(e,!1,function(e){var c=r++,l=!1;n.push(void 0),o++,t.resolve(e).then(function(e){l||(l=!0,n[c]=e,--o||i(n))},a)}),--o||i(n)});return r.e&&a(r.v),n.promise},race:function(e){var t=this,n=qt(t),i=n.reject,a=_t(function(){Be(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return a.e&&i(a.v),n.promise}}),M(M.P+M.R,"Promise",{finally:function(e){var t=dt(this,c.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return Ct(t,e()).then(function(){return n})}:e,n?function(n){return Ct(t,e()).then(function(){throw n})}:e)}}),M(M.S,"Promise",{try:function(e){var t=bt.f(this),n=_t(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}});var $t=c.Promise,en=e(t(function(e){e.exports={default:$t,__esModule:!0}})),tn=function(e,t){var n=(c.Object||{})[e]||Object[e],i={};i[e]=t(n),M(M.S+M.F*v(function(){n(1)}),"Object",i)};tn("getPrototypeOf",function(){return function(e){return de(le(e))}});var nn=c.Object.getPrototypeOf,an=e(t(function(e){e.exports={default:nn,__esModule:!0}})),rn=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},on=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),cn=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ln=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},un={},sn=[],dn=new ut,vn=null,pn=null,fn=null,gn=null,yn=null,hn=null,mn=null,Tn=null,An=null,wn=null,kn=function(){function e(){rn(this,e)}return on(e,null,[{key:"viewContext",get:function(){return un},set:function(e){un=e}},{key:"activeTags",get:function(){return sn},set:function(e){sn=e}},{key:"scheduledActiveTagTasks",get:function(){return dn},set:function(e){dn=e}},{key:"dataSetId",get:function(){return vn},set:function(e){vn=e}},{key:"viewName",get:function(){return pn},set:function(e){pn=e}},{key:"appName",get:function(){return fn},set:function(e){fn=e}},{key:"coordinates",get:function(){return gn},set:function(e){gn=e}},{key:"pageUrl",get:function(){return yn},set:function(e){yn=e}},{key:"pageTitle",get:function(){return hn},set:function(e){hn=e}},{key:"deviceResolution",get:function(){return mn},set:function(e){mn=e}},{key:"deviceId",get:function(){return Tn},set:function(e){Tn=e}},{key:"deviceIdVerification",get:function(){return An},set:function(e){An=e}},{key:"sessionId",get:function(){return wn},set:function(e){wn=e}}]),e}(),Nn=function(){function e(){rn(this,e)}return on(e,[{key:"dataStore",get:function(){return kn}}]),e}(),In=function(){function e(){rn(this,e)}return on(e,[{key:"dataStore",get:function(){return kn}}]),e}(),Sn=function(e){function t(){return rn(this,t),ln(this,(t.__proto__||an(t)).call(this))}return cn(t,In),on(t,[{key:"attachAllActiveTagEvents",value:function(){var e=this;this.dataStore.activeTags.forEach(function(t){if("Player"===t.event.eventType)switch(t.event.eventName){case"Media Start":e.startEventTrigger();break;case"Media Play":e.playEventTrigger();break;case"Media Pause":e.pauseEventTrigger();break;case"Media Finish":e.finishEventTrigger();break;case"Media Dispose":e.disposeEventTrigger();break;case"Media Heartbeat":e.isAliveEventTrigger();break;case"Media Seek":e.seekingEventTrigger();break;case"Media Error":e.errorEventTrigger();break;case"Media Loaded Data":e.loadStartEventTrigger();break;case"Media Full Screen":e.fullScreenEventTrigger();break;case"Media Mute":e.muteEventTrigger();break;default:console.log(t.event.eventName+": Event trigger not found")}})}},{key:"attachActiveTagEvent",value:function(e,t,n){console.log("Method not implemented")}},{key:"startEventTrigger",value:function(){console.log("Method not implemented")}},{key:"playEventTrigger",value:function(){console.log("Method not implemented")}},{key:"pauseEventTrigger",value:function(){console.log("Method not implemented")}},{key:"finishEventTrigger",value:function(){console.log("Method not implemented")}},{key:"disposeEventTrigger",value:function(){console.log("Method not implemented")}},{key:"isAliveEventTrigger",value:function(){console.log("Method not implemented")}},{key:"loadStartEventTrigger",value:function(){console.log("Method not implemented")}},{key:"loadEndEventTrigger",value:function(){console.log("Method not implemented")}},{key:"seekingEventTrigger",value:function(){console.log("Method not implemented")}},{key:"subtitleChangeEventTrigger",value:function(){console.log("Method not implemented")}},{key:"adStartEventTrigger",value:function(){console.log("Method not implemented")}},{key:"adClickEventTrigger",value:function(){console.log("Method not implemented")}},{key:"adSkipEventTrigger",value:function(){console.log("Method not implemented")}},{key:"adEndEventTrigger",value:function(){console.log("Method not implemented")}},{key:"bufferChangeEventTrigger",value:function(){console.log("Method not implemented")}},{key:"bitRateChangeEventTrigger",value:function(){console.log("Method not implemented")}},{key:"errorEventTrigger",value:function(){console.log("Method not implemented")}},{key:"fullScreenEventTrigger",value:function(){console.log("Method not implemented")}},{key:"muteEventTrigger",value:function(){console.log("Method not implemented")}}]),t}(),Mn={f:Object.getOwnPropertySymbols},bn={f:{}.propertyIsEnumerable},_n=Object.assign,Cn=!_n||v(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=_n({},e)[n]||Object.keys(_n({},t)).join("")!=i})?function(e,t){for(var n=le(e),i=arguments.length,a=1,r=Mn.f,o=bn.f;i>a;)for(var c,l=P(arguments[a++]),u=r?W(l).concat(r(l)):W(l),s=u.length,d=0;s>d;)o.call(l,c=u[d++])&&(n[c]=l[c]);return n}:_n;M(M.S+M.F,"Object",{assign:Cn});var En=c.Object.assign,Pn=e(t(function(e){e.exports={default:En,__esModule:!0}}));tn("keys",function(){return function(e){return W(le(e))}});var xn=c.Object.keys,On=e(t(function(e){e.exports={default:xn,__esModule:!0}})),Dn=c.JSON||(c.JSON={stringify:JSON.stringify}),Vn=function(e){return Dn.stringify.apply(Dn,arguments)},jn=e(t(function(e){e.exports={default:Vn,__esModule:!0}})),Rn=function(){function e(){rn(this,e)}return on(e,null,[{key:"request",value:function(e){return new en(function(t,n){var i=new XMLHttpRequest,a=null;i.open(e.method,"https://marker.konograma.com/"+e.url||""+e.params||"",!0),e.data&&(a=jn(e.data),i.setRequestHeader("Content-type","application/json; charset=utf-8")),e.headers&&On(e.headers).forEach(function(t){i.setRequestHeader(t,e.headers[t])}),i.onload=function(){i.status>=200&&i.status<300?i.response?t(JSON.parse(i.response)):t():n(i.statusText)},i.onerror=function(){n(i.statusText)},i.ontimeout=function(){n(i.statusText)},i.onabort=function(){n(i.statusText)},i.send(a)})}},{key:"get",value:function(e,t){return this.request({method:"GET",url:e,params:t})}},{key:"post",value:function(e,t,n){return this.request({method:"POST",url:e,data:t,params:n})}},{key:"put",value:function(e,t,n){return this.request({method:"PUT",url:e,data:t,params:n})}},{key:"delete",value:function(e,t){return this.request({method:"DELETE",url:e,params:t})}}]),e}(),Ln=function(e){function t(){return rn(this,t),ln(this,(t.__proto__||an(t)).apply(this,arguments))}return cn(t,Rn),on(t,null,[{key:"record",value:function(e,t){return this.post("mark",{datasetid:e,mark:t})}}]),t}(),Fn=function(){function e(){rn(this,e)}return on(e,null,[{key:"getCookieName",value:function(){return"kng_aflow_v1.0"}},{key:"getOldCookieName",value:function(){return"kng_aflow"}},{key:"getDomine",value:function(){for(var e=window.location.hostname.split("."),t=e.length-1,n="";t>=0&&t>=e.length-2;)n="."+e[t]+n,t-=1;return n}},{key:"setCookieValue",value:function(e,t){var n={};try{(n=JSON.parse(this.getBaseCookie(this.getCookieName())))[e]=t}catch(i){n[e]=t}var i=new Date;i.setFullYear(i.getFullYear()+1);var a=this.getCookieName()+"="+jn(n)+";expires="+i.toUTCString()+";domain="+this.getDomine()+";path=/";document.cookie=a}},{key:"getCookieValue",value:function(e){try{var t=this.verifyOnCookieVersion(this.getCookieName(),e);return null===t&&null!==(t=this.verifyOnCookieVersion(this.getOldCookieName(),e))&&this.setCookieValue(e,t),t}catch(e){return null}}},{key:"verifyOnCookieVersion",value:function(e,t){var n=this.getBaseCookie(e),i=""!==n?JSON.parse(n):{};return i.hasOwnProperty(t)?i[t]:null}},{key:"getBaseCookie",value:function(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""}}]),e}(),Un=function(){function e(){rn(this,e)}return on(e,null,[{key:"getCurrentLocation",value:function(){return new en(function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var n=[t.coords.latitude,t.coords.longitude];e(n)},function(e){t(e)},{enableHighAccuracy:!0,timeout:1e4}):t(new Error("Geolocation not supported"))})}},{key:"getPageUrl",value:function(){return window.location.href}},{key:"getTabTitlePage",value:function(){return document.title}},{key:"getDeviceResolution",value:function(){return[window.screen.availWidth,window.screen.availHeight]}},{key:"getScrollPercent",value:function(){var e=document.documentElement,t=document.body,n="scrollTop",i="scrollHeight";if((e[i]||t[i])<=window.innerHeight)return 1;if(!e[n]&&!t[n])return 0;var a=(e[n]||t[n])/((e[i]||t[i])-window.innerHeight);return Math.round(100*a)/100}}]),e}(),Hn=function(e){function t(){return rn(this,t),ln(this,(t.__proto__||an(t)).call(this))}return cn(t,In),on(t,[{key:"recordActiveTagEvent",value:function(e,t){var n={};return n.tag=e.activeTagId,this.dataStore.viewContext&&this.dataStore.viewContext.digitalData.user&&this.dataStore.viewContext.digitalData.user.profile?n.uid=this.dataStore.viewContext.digitalData.user.profile.profileID:this.dataStore.viewContext.userId,n.sid=this.dataStore.sessionId,n.did=this.dataStore.deviceId,this.dataStore.viewContext&&this.dataStore.viewContext.digitalData&&(n.cid=this.dataStore.viewContext.digitalData.pageInstanceID),n.vdid=this.dataStore.deviceIdVerification,n.coord=this.dataStore.coordinates,n.cdata=Pn({},this.dataStore.viewContext,t),n.cdata.ref=document.referrer,n.cdata.pageUrl=Un.getPageUrl(),n.cdata.pageTitle=Un.getTabTitlePage(),n.cdata.deviceResolution=Un.getDeviceResolution(),n.cdata.scroll=Un.getScrollPercent(),Fn.setCookieValue("sidex",(new Date).getTime()),Ln.record(this.dataStore.dataSetId,n)}}]),t}(),Gn=null,Bn=function(e){function t(e){rn(this,t);var n=ln(this,(t.__proto__||an(t)).call(this));return n.player=e,n.playbackRate=0,n.bufferPercentage=0,n.milliSecsPlayed=0,n.playerStatusBefore="LOADED",n.chunkTimeStarted=new Date,Gn=new Hn,n.attachAllActiveTagEvents(),n}return cn(t,Sn),on(t,[{key:"getTotalSecondsPlayed",value:function(e,t){"PAUSED"===e&&"PLAYING"===this.playerStatusBefore?(this.playerStatusBefore="PAUSED",this.milliSecsPlayed+=(new Date).getTime()-this.chunkTimeStarted.getTime()):"PLAYING"===e&&"PAUSED"===this.playerStatusBefore?(this.playerStatusBefore="PLAYING",this.chunkTimeStarted=new Date):"PLAYING"===e&&"PLAYING"===this.playerStatusBefore&&(this.milliSecsPlayed+=(new Date).getTime()-this.chunkTimeStarted.getTime(),this.chunkTimeStarted=new Date)}},{key:"buildContentData",value:function(e,t){var n={},i="",a="";try{e.currentSrc()&&(i=e.currentSrc().split("/").pop(),a=e.currentSrc())}catch(e){i="",a=""}return n.playerStatus=e.paused()?"PAUSED":"PLAYING",n.mediaType=e.currentType(),n.mediaDuration=Math.floor(e.duration()),n.mediaName=i,n.mediaUrl=a,this.getTotalSecondsPlayed(n.playerStatus,t?t.type:"unkown"),n.secsPlayed=Math.floor(this.milliSecsPlayed/1e3),t&&(n.mediaResolution=[t.target.clientWidth,t.target.clientHeight]),n.currentPosition=Math.floor(e.currentTime()),n.playbackRate=e.playbackRate(),n.bufferPercentage=Math.round(100*e.bufferedPercent()),n.fullScreenStatus=e.isFullscreen(),n.muteStatus=e.muted(),n}},{key:"getFilteredActiveTag",value:function(e,t,n){for(var i in e){var a=e[i];if(a.event.eventType==n&&a.event.eventName==t)return a}}},{key:"attachActiveTagEvent",value:function(e,t,n){var i=this;this.player.on(t,function(t){console.log("Here in event %s",t.type);var a=i.buildContentData(i.player,t);Gn.recordActiveTagEvent(e,a).then(function(e){console.log(e)}).catch(function(e){console.log(e)}),n(a)})}},{key:"startEventTrigger",value:function(){var e=this;this.player.one("playing",function(t){e.milliSecsPlayed=0,e.playerStatusBefore="PLAYING",e.chunkTimeStarted=new Date;var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Start","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){console.log(e)}).catch(function(e){console.log(e)})})}},{key:"playEventTrigger",value:function(){var e=this;this.player.on("playing",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Play","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){console.log(e)}).catch(function(e){console.log(e)})})}},{key:"pauseEventTrigger",value:function(){var e=this;this.player.on("pause",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Pause","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){console.log(e)}).catch(function(e){console.log(e)})})}},{key:"finishEventTrigger",value:function(){var e=this;this.player.on("ended",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Finish","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){console.log(e)}).catch(function(e){console.log(e)})})}},{key:"disposeEventTrigger",value:function(){var e=this;this.player.on("dispose",function(t){e.videoIsDestroyed=!0;var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Dispose","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){console.log(e)}).catch(function(e){console.log(e)})})}},{key:"isAliveEventTrigger",value:function(){var e=this,t=this.getFilteredActiveTag(this.dataStore.activeTags,"Media Heartbeat","Player");this.isAliveInterval=setInterval(function(){if(!e.videoIsDestroyed&&t){if(!t.event.triggerOnStart&&e.player.paused())return;var n=e.buildContentData(e.player);Gn.recordActiveTagEvent(t,n).then(function(e){}).catch(function(e){console.log(e)})}},t.event.periodicity||3e4)}},{key:"dispose",value:function(){this.player.off(),clearInterval(this.isAliveInterval),clearInterval(this.bitRateChangeInterval),clearInterval(this.bufferChangeInterval)}},{key:"loadStartEventTrigger",value:function(){var e=this;this.player.on("loadeddata",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Loaded Data","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){}).catch(function(e){console.log(e)})})}},{key:"loadEndEventTrigger",value:function(){var e=this;this.player.on("loadedmetadata",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Load End","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){console.log(e)}).catch(function(e){console.log(e)})})}},{key:"seekingEventTrigger",value:function(){var e=this;this.player.on("seeking",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Seek","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){}).catch(function(e){console.log(e)})})}},{key:"bufferChangeEventTrigger",value:function(){var e=this;this.bufferChangeInterval=setInterval(function(){if(e.bufferPercentage!=Math.round(100*e.player.bufferedPercent())){var t=e.buildContentData(e.player),n=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Buffer Change","Player");n&&Gn.recordActiveTagEvent(n,t).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}},1e3)}},{key:"bitRateChangeEventTrigger",value:function(){var e=this;this.bitRateChangeInterval=setInterval(function(){if(e.playbackRate!=e.player.playbackRate()){var t=e.buildContentData(e.player),n=e.getFilteredActiveTag(e.dataStore.activeTags,"Media BitRate Change","Player");n&&Gn.recordActiveTagEvent(n,t).then(function(e){console.log(e)}).catch(function(e){console.log(e)})}},1e3)}},{key:"errorEventTrigger",value:function(){var e=this;this.player.on("error",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Error","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){}).catch(function(e){console.log(e)})})}},{key:"fullScreenEventTrigger",value:function(){var e=this;this.player.on("fullscreenchange",function(t){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Full Screen","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){}).catch(function(e){console.log(e)})})}},{key:"muteEventTrigger",value:function(){var e=this;this.player.on("volumechange",function(t){if(e.player.muted()){var n=e.buildContentData(e.player,t),i=e.getFilteredActiveTag(e.dataStore.activeTags,"Media Mute","Player");i&&Gn.recordActiveTagEvent(i,n).then(function(e){}).catch(function(e){console.log(e)})}})}},{key:"adStartEventTrigger",value:function(){}},{key:"adClickEventTrigger",value:function(){}},{key:"adSkipEventTrigger",value:function(){}},{key:"adEndEventTrigger",value:function(){}},{key:"subtitleChangeEventTrigger",value:function(){}}]),t}(),qn=function(e){function t(e){return rn(this,t),ln(this,(t.__proto__||an(t)).call(this,e))}return cn(t,Bn),on(t,[{key:"buildContentData",value:function(e,t){var n={},i="",a="";try{e.currentSrc()&&(i=e.currentSrc().split("/").pop(),a=e.currentSrc())}catch(e){i="",a=""}n.mediaName=i,n.mediaUrl=a,n.mediaType=e.currentType(),n.mediaDuration=Math.floor(e.duration()),n.playerStatus=e.paused()?"PAUSED":"PLAYING",n.currentPosition=Math.floor(e.currentTime()),n.playbackRate=e.playbackRate(),n.bufferPercentage=Math.round(100*e.bufferedPercent()),n.secsPlayed=e.rtvePlayer.options.mediaConfig.assetConfig.realTime,t&&(n.mediaResolution=[t.target.clientWidth,t.target.clientHeight]),n.rtveAsset={};for(var r=["categoryName","categoryUid","channel","dateOfEmission","duration","episode","id","programRef","programTitle","sgce","statUrl","state","title"],o=0;o<r.length;o++)n.rtveAsset[r[o]]=e.rtvePlayer.options.mediaConfig.assetConfig[r[o]];return n}}]),t}(),Yn=null,zn=function(e){function t(){rn(this,t);var e=ln(this,(t.__proto__||an(t)).call(this));return Yn=new ut,e}return cn(t,Nn),on(t,[{key:"initializePlayerService",value:function(e,t,n){var i=null;if(!Yn.get(e)){switch(t){case"videojs":i=new Bn(n);break;case"rtvevideojs":i=new qn(n);break;default:throw new Error("You must specify a valid player type")}Yn.set(e,i)}}},{key:"addActiveTagListener",value:function(e,t,n,i){Yn.get(e).attachActiveTagEvent(t,n,i)}},{key:"disposePlayerService",value:function(e){Yn.get(e).dispose()}},{key:"disposePlayerServices",value:function(){Yn.forEach(function(e){e.dispose()})}}]),t}(),Wn=function(e){function t(){return rn(this,t),ln(this,(t.__proto__||an(t)).apply(this,arguments))}return cn(t,Rn),on(t,null,[{key:"getActiveTags",value:function(e){return new en(function(e,t){e(Jn)}).catch(function(e){reject(e)})}}]),t}(),Jn=[{activeTagId:"0",tagName:"Page View",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"0",eventName:"View",eventType:"Triggered"}},{activeTagId:"1",tagName:"Modal View",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"1",eventName:"Component View",eventType:"Triggered"}},{activeTagId:"2",tagName:"View Heartbeat",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"2",eventName:"View Heartbeat",eventType:"Timed",periodicity:3e4,triggerOnStart:!1}},{activeTagId:"3",tagName:"Media Start",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"3",eventName:"Media Start",eventType:"Player"}},{activeTagId:"4",tagName:"Media Play",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"4",eventName:"Media Play",eventType:"Player"}},{activeTagId:"5",tagName:"Media Pause",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"5",eventName:"Media Pause",eventType:"Player"}},{activeTagId:"6",tagName:"Media Finish",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"6",eventName:"Media Finish",eventType:"Player"}},{activeTagId:"7",tagName:"Media Dispose",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"7",eventName:"Media Dispose",eventType:"Player"}},{activeTagId:"8",tagName:"Media Heartbeat",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"8",eventName:"Media Heartbeat",eventType:"Player",periodicity:3e4,triggerOnStart:!1}},{activeTagId:"9",tagName:"Media Seek",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"9",eventName:"Media Seek",eventType:"Player"}},{activeTagId:"10",tagName:"Share",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"10",eventName:"Share",eventType:"Triggered"}},{activeTagId:"11",tagName:"Media Error",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"11",eventName:"Media Error",eventType:"Player"}},{activeTagId:"12",tagName:"Media Loaded Data",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"12",eventName:"Media Loaded Data",eventType:"Player"}},{activeTagId:"13",tagName:"Before Unload",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"13",eventName:"Before Unload",eventType:"Triggered"}},{activeTagId:"14",tagName:"Media Full Screen",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"14",eventName:"Media Full Screen",eventType:"Player"}},{activeTagId:"15",tagName:"Media Mute",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"15",eventName:"Media Mute",eventType:"Player"}},{activeTagId:"16",tagName:"Adblock",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"16",eventName:"Adblock",eventType:"Triggered"}},{activeTagId:"17",tagName:"Infinite Scroll Down",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"17",eventName:"Infinite Scroll Down",eventType:"Triggered"}},{activeTagId:"18",tagName:"Comment",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"18",eventName:"Comment",eventType:"triggered"}},{activeTagId:"19",tagName:"Click",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"19",eventName:"Click",eventType:"triggered"}},{activeTagId:"20",tagName:"Search",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"20",eventName:"Search",eventType:"triggered"}},{activeTagId:"21",tagName:"Login Request",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"21",eventName:"Login Request",eventType:"triggered"}},{activeTagId:"22",tagName:"Login Response",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"22",eventName:"Login Response",eventType:"triggered"}},{activeTagId:"23",tagName:"Change Password",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"23",eventName:"Change Password",eventType:"triggered"}},{activeTagId:"24",tagName:"Password Recovery",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"24",eventName:"Password Recovery",eventType:"triggered"}},{activeTagId:"25",tagName:"Request Password Recovery",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"25",eventName:"Request Password Recovery",eventType:"triggered"}},{activeTagId:"26",tagName:"Validate Password Recovery",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"26",eventName:"Validate Password Recovery",eventType:"triggered"}},{activeTagId:"27",tagName:"Sign On",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"25",eventName:"Sign On",eventType:"triggered"}},,{activeTagId:"28",tagName:"Register",deviceType:{deviceTypeId:"0",deviceName:"All",brand:"Any",osName:"Any"},application:{applicationId:"0",applicationName:"All",description:"A Mark Collector application."},applicationView:{viewId:"0",viewName:"All",description:"A view within a Mark Collector application."},event:{eventId:"26",eventName:"Register",eventType:"triggered"}}],Kn=function(e){function t(){return rn(this,t),ln(this,(t.__proto__||an(t)).call(this))}return cn(t,In),on(t,[{key:"getActiveTags",value:function(e,t){return Wn.getActiveTags({appName:e,viewName:t})}}]),t}(),Xn=null,Qn={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"},Zn=function(e){return!document[e]},$n=function(e){function t(){rn(this,t);var e=ln(this,(t.__proto__||an(t)).call(this));for(var n in e.markService=new Hn,Qn)if(n in document){Xn=n;break}return e}return cn(t,In),on(t,[{key:"startTimedActiveTag",value:function(e){var t=this,n=this.dataStore.scheduledActiveTagTasks.get(e.activeTagId);return n&&n.taskId>0?n:(n={activeTag:e},e.triggerOnStart&&Zn(Xn)&&this.markService.recordActiveTagEvent(n.activeTag,{}),n.taskId=setInterval(function(){Zn(Xn)&&t.markService.recordActiveTagEvent(n.activeTag,{})},e.event.periodicity),this.dataStore.scheduledActiveTagTasks.set(e.activeTagId,n),n)}},{key:"stopTimedActiveTag",value:function(e){var t=this.dataStore.scheduledActiveTagTasks.get(e.activeTagId);return t&&(clearInterval(t.taskId),t.taskId=null),t}}]),t}(),ei=null,ti=null,ni=null,ii=function(e){function t(){rn(this,t);var e=ln(this,(t.__proto__||an(t)).call(this));return ei=new Hn,ti=new Kn,ni=new $n,e}return cn(t,Nn),on(t,[{key:"getActiveTags",value:function(){return 2===arguments.length?ti.getActiveTags(arguments[0],arguments[1]):this.dataStore.activeTags}},{key:"getScheduledActiveTagTasks",value:function(){return this.dataStore.scheduledActiveTagTasks}},{key:"recordActiveTagEvent",value:function(e,t){return ei.recordActiveTagEvent(e,t)}},{key:"startTimedActiveTag",value:function(e){return ni.startTimedActiveTag(e)}},{key:"stopTimedActiveTag",value:function(e){return ni.stopTimedActiveTag(e)}}]),t}(),ai=function(){function e(){rn(this,e)}return on(e,null,[{key:"generateUUID",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})}}]),e}(),ri=null,oi=null;return function(){function e(){throw rn(this,e),new Error("MarkCollector is not an instantiable class. You need to use static methods using the class directly")}return on(e,null,[{key:"init",value:function(t,n,i,a,r){return ri=new zn,oi=new ii,kn.dataSetId=t,kn.appName=n,kn.viewName=i,kn.viewContext=a,kn.pageUrl=Un.getPageUrl(),kn.pageTitle=Un.getTabTitlePage(),kn.deviceResolution=Un.getDeviceResolution(),e.initializeSdkCookies(r),r&&r.enableGps&&Un.getCurrentLocation().then(function(e){kn.coordinates=e}).catch(function(e){console.log(e)}),new en(function(e,t){oi.getActiveTags(n,i).then(function(t){t.forEach(function(e){"Timed"===e.event.eventType&&oi.startTimedActiveTag(e)}),kn.activeTags=t,e(t)}).catch(function(e){t(e)})})}},{key:"initializeSdkCookies",value:function(e){var t=Fn.getCookieValue("did");t||(t=ai.generateUUID(),Fn.setCookieValue("did",t)),kn.deviceId=t;var n=Fn.getCookieValue("vdid"),i=0;n?i=(new Date).getTime()-Number(n)<864e5?2:0:(Fn.setCookieValue("vdid",(new Date).getTime()),i=1),kn.deviceIdVerification=i;var a=Fn.getCookieValue("sidex"),r=e&&e.sessionTimeOutSeconds?e.sessionTimeOutSeconds:1800;if(!!window.MSInputMethodContext&&!!document.documentMode&&(String.prototype.padStart=function(e,t){for(var n=this+"";n.length<e;)n=t+n;return n}),!a||(new Date).getTime()-Number(a)>1e3*r){var o=(new Date).getTime();Fn.setCookieValue("sidex",o);var c=("00000"+Math.floor(1e5*Math.random())).slice(-5);Fn.setCookieValue("sid",t+"-"+c)}kn.sessionId=Fn.getCookieValue("sid")}},{key:"getViewContext",value:function(){return kn.viewContext}},{key:"getDid",value:function(){return kn.deviceId}},{key:"setViewContext",value:function(e){kn.viewContext=e}},{key:"destroy",value:function(){kn.scheduledActiveTagTasks.forEach(function(e){clearInterval(e.taskId)}),ri.disposePlayerServices(),kn.viewContext={},kn.activeTags=[],kn.scheduledActiveTagTasks=new ut,kn.dataSetId=null,kn.viewName=null,kn.appName=null,kn.coordinates=null,kn.pageUrl=null,kn.pageTitle=null,kn.deviceResolution=null}},{key:"playerController",get:function(){return ri}},{key:"eventController",get:function(){return oi}}]),e}()}();
