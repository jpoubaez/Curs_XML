<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252"><script>var BF_prop={"BannerId":"5fd7ebcb7e08bb17d0c47d92","BannerFormatId":"5fd7ebcb7e08bb17d0c47d90","BannerFormatName":null,"BannerSizeWidth":728,"BannerSizeHeight":90,"TextId":"5fd2563f553a7318d042c1b0","TextName":"Spanish","TextLanguageId":"59c9fbac31ae90128431d345","TextLanguageName":"Spanish","TextLanguageCulture":"es-es","TextCultureName":"es-es","AccountId":"59c910d931ae8f128419d636","BrandId":"59c9120b31ae8f128419d688","CampaignId":"5fd2563f553a7318d042c1ac","CampaignName":"Generic","CampaignLabels":null,"FolderName":"01. January Sales (Europe + America)","FolderPath":["2021","01. January Sales (Europe + America)"],"DomainName":"bannerflow.blob.core.windows.net"};</script>
<script>!function(){function n(n,o){var r,i,a;if(window.JSON&&window.parent&&window.parent.postMessage){if(r=t.clickpixel,i={},r&&(a=e(r),a.data))try{i=JSON.parse(a.data)}catch(n){}window.parent.postMessage(JSON.stringify({event:n,url:window.location.href,data:o,params:i}),'*')}}function e(n){n&&n.indexOf('?')>-1&&(n=n.substring(n.indexOf('?')+1));for(var e,t=/([^&=]+)=?([^&]*)/g,o=function(n){try{n=decodeURIComponent(n.replace(/\+/g,' '))}catch(n){}return n},r=n||window.location.search.substring(1),i={};e=t.exec(r);)i[o(e[1])]=o(e[2]);return i}var t=e(),o='https://www.melia.com';document.onclick=window.bannerClick=function(e){var r,i;e=e||window.event,r=o,i=r,t.targeturl&&(i=decodeURIComponent(t.targeturl)),window.onBannerClick&&'function'==typeof window.onBannerClick&&(i=window.onBannerClick(e,r)),(''+(i||'')).indexOf('//')>-1&&'#'!==i&&'none'!==i&&(i=i.replace(/\[target_url\]/gi,r).replace(/\[target_url_esc\]/gi,encodeURIComponent(r)).replace(/\[target_url_esc_esc\]/gi,encodeURIComponent(encodeURIComponent(r))),n('click',{targetUrl:r,x:e.clientX,y:e.clientY}),window.open(i,t.targetwindow||'_blank'))},window.BF={DefaultTargetUrl:o,trackEvent:n,bannerClick:bannerClick}}();</script>
<script>// Parameters
var queries = new Object();
window.location.search.replace(new RegExp('([^?=&]+)(=([^&]*))?', 'g'), function( $0, $1, $2, $3 ){ queries[ $1 ] = $3; });

function onBannerClick(e, targetUrl)  { 

    // Open window
    var clickUrl = targetUrl;
    if (queries['targeturl'] && targetUrl.indexOf(';cpdir=') == -1) // Overridden Target URL via placement
      clickUrl = decodeURIComponent(queries['targeturl']);
    
    if(clickUrl) {
        // Resolve possible macros
        clickUrl = clickUrl.replace(/\[target_url\]/gi, targetUrl).replace(/\[target_url_esc\]/gi, encodeURIComponent(targetUrl)).replace(/\[target_url_esc_esc\]/gi, encodeURIComponent(encodeURIComponent(targetUrl)));

        //This should be injected into onBannerClick. makes it use the new click tracking
        if((window.BF ? window.BF : window).bannerClick) {
            return clickUrl;
        }

        // Custom click tracking pixel
        if (queries['clickpixel']) {
          var clickpixel = new Image();
          clickpixel.src = decodeURIComponent(queries['clickpixel']);
        }

        // Custom click script source
        if (queries['clickscript']) {
            var clickScript = document.createElement('script');
            clickScript.type = 'text/javascript';
            clickScript.async = true;
            clickScript.src = decodeURIComponent(queries['clickscript']);
            var firstScriptOnPage = document.getElementsByTagName('script');
            if (firstScriptOnPage.length > 0)
                firstScriptOnPage[0].parentNode.insertBefore(clickScript, firstScriptOnPage[0]);
        }

        // Open window
        window.open(clickUrl, queries['targetwindow']);
    }
}

// Report that feed has loaded (for Adform DCO to know when products can be sent)
var externalFeed = window.setInterval(function() {
    if (window.BF && window.BF.LastParsedFeedData) {
       window.clearInterval(externalFeed);
       // Report that feed is loaded
       parent.postMessage({ type: 'feed_loaded' }, '*');
    }
}, 20);

// Listen for possible DCO product data from Adform
window.addEventListener('message', function(e) {
    if (typeof e == 'object') {
        if (e.data && e.data.type) {
            switch (e.data.type) {
                case 'feed_data':
                    var feed = BF.LastParsedFeedData;
                    var feedBackup = JSON.parse(BF.FeedBackup);
                    var dcoData = e.data.data;
                    var numProducts = dcoData.product_name.length;

                    // Construct deeplinks (product_link and f1custom_url) beforing binding DCO data to banner feed
                    if (e.data.version != 'hybrid') {
                        // Hybrid version has already prepared links (below not needed in that case)
                        if (dcoData.$link && dcoData.$url_prefix && dcoData.$url_suffix) {
                            for (var i = 0; i < numProducts; i++) {
                                if (dcoData.product_deeplink) {
                                    dcoData.product_deeplink[i] = constructProductDeeplink(dcoData.$link[i], dcoData.$url_prefix[i], dcoData.$url_suffix[i], dcoData.product_deeplink[i]);
                                }
                                if (dcoData.f1custom_url) {
                                    dcoData.f1custom_url[i] = constructProductDeeplink(dcoData.$link[i], dcoData.$url_prefix[i], dcoData.$url_suffix[i], dcoData.f1custom_url[i]);
                                }
                            }
                        }
                    }


                    // Trim all feed field's value and clickUrl values to match number of dco products
                    for (var i=0; i<feed.length; i++) {
                        if (feed[i].values) {
                             feed[i].values = feed[i].values.slice(0, numProducts);
                        }
                        if (feed[i].clickUrls) {
                             feed[i].clickUrls = feed[i].clickUrls.slice(0, numProducts);
                        }
                        if (feedBackup.Feeds[i].Values) {
                             feedBackup.Feeds[i].Values = feedBackup.Feeds[i].Values.slice(0, numProducts);
                        }
                        if (feedBackup.Feeds[i].TargetUrls) {
                             feedBackup.Feeds[i].TargetUrls = feedBackup.Feeds[i].TargetUrls.slice(0, numProducts);
                        }
                    }

                    // Inject DCO data to banner feed
                    for (var dataProp in dcoData) {
                        var bfFeedField = dataProp.replace('$', 'adform_');
                        var field = feed.filter(function (f) { return f.name.toLowerCase() == bfFeedField.toLowerCase(); });
                        if (field.length > 0) {
                            field[0].values = dcoData[dataProp];
// if (dataProp=='product_name')
//     console.log(dcoData[dataProp]);

                            if (e.data.version == 'hybrid') {
                                if (endsWith(dataProp, 'url') || endsWith(dataProp, 'link') || endsWith(dataProp, 'deeplink')) {
                                    field[0].clickUrls = field[0].values;
                                } else {
                                    // General deeplink
                                    field[0].clickUrls = dcoData.$link ? dcoData.$link : Array.apply(null, { length: field[0].values.length });
                                }
                            } else {
                              if (dataProp == 'f1custom_url') {
                                // Optional intro frame deeplink
                                field[0].clickUrls = field[0].values;
                              } else {
                                // General deeplink
                                field[0].clickUrls = dcoData.product_deeplink ? dcoData.product_deeplink : Array.apply(null, { length: field[0].values.length });
                              }
                           }
                                  
                        }
                        // Workaround due to set feed being overridden when using BannerFlow.nextLoop() etc.
                        var fieldBackup = feedBackup.Feeds.filter(function (f) { return f.Name.toLowerCase() == bfFeedField.toLowerCase(); });
                        if (fieldBackup.length > 0) {
                            fieldBackup[0].Values = field[0].values;
                            fieldBackup[0].TargetUrls = field[0].clickUrls;
                        }
                    }
                    BF.FeedBackup = JSON.stringify(feedBackup);
                    BF.setFeed(feed);

                    //console.log('banner feed data', dcoData, feedBackup);
                break;
            }
        }
    }
});

function endsWith(str, suffix) {
    return str.toLowerCase().indexOf(suffix.toLowerCase(), str.length - suffix.length) !== -1;
}

function constructProductDeeplink(urlBase,  urlPrefix, urlSuffix, urlProduct) {
    var deeplink = urlBase.split(';cpdir=')[0];
    if (urlPrefix.length > 0) {
        deeplink += ';cpdir=' + encodeURIComponent(urlPrefix + encodeURIComponent(urlProduct + urlSuffix));
    } else {
        deeplink += ';cpdir=' + encodeURIComponent(urlProduct + urlSuffix);
    }
    return deeplink;
}</script><meta name="robots" content="noindex, nofollow"></head>
<body style="margin:0;">
<img src="5fd7ebcb7e08bb17d0c47d92_data/5fd7ebcb7e08bb17d0c47d92.webp" style="cursor:pointer;width:100%;height:auto">

</body></html>