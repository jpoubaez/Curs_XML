/*! For license information please see embed.js.LICENSE.txt */
var Coral=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=7)}([,function(t,e,n){(function(i){var r;function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(s){var a=Object.hasOwnProperty,c=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};function l(){this._events={},this._conf&&h.call(this,this._conf)}function h(t){t&&(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),void 0!==t.maxListeners&&(this._maxListeners=t.maxListeners),t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this._newListener=t.newListener),t.removeListener&&(this._removeListener=t.removeListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),t.ignoreErrors&&(this.ignoreErrors=t.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function u(t,e){var n="(node) warning: possible EventEmitter memory leak detected. "+t+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+e+"."),void 0!==i&&i.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning",r.emitter=this,r.count=t,i.emitWarning(r)}else console.error(n),console.trace&&console.trace()}var f=function(t,e,n){var i=arguments.length;switch(i){case 0:return[];case 1:return[t];case 2:return[t,e];case 3:return[t,e,n];default:for(var r=new Array(i);i--;)r[i]=arguments[i];return r}};function d(t,e,n,i){var r=Object.assign({},e);if(!t)return r;if("object"!==o(t))throw TypeError("options must be an object");var s,c,l,h=Object.keys(t),u=h.length;function f(t){throw Error('Invalid "'+s+'" option value'+(t?". Reason: "+t:""))}for(var d=0;d<u;d++){if(s=h[d],!i&&!a.call(e,s))throw Error('Unknown "'+s+'" option');void 0!==(c=t[s])&&(l=n[s],r[s]=l?l(c,f):c)}return r}function m(t,e){return"function"==typeof t&&t.hasOwnProperty("prototype")||e("Promise option must be a constructor"),t}function p(t,e){return"function"!=typeof t&&e("Promise option must be a function"),t}function v(t,e,n){var i,r,o,s=0,a=new t((function(c,l,h){function u(){r&&(r=null),s&&(clearTimeout(s),s=0)}n=d(n,{timeout:0,overload:!1},{timeout:function(t,e){return("number"!=typeof(t*=1)||t<0||!Number.isFinite(t))&&e("timeout must be a positive number"),t}}),i=!n.overload&&"function"==typeof t.prototype.cancel&&"function"==typeof h;var f=function(t){u(),c(t)},m=function(t){u(),l(t)};i?e(f,m,h):(r=[function(t){m(t||Error("canceled"))}],e(f,m,(function(t){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof t)throw TypeError("onCancel callback must be a function");r.push(t)})),o=!0),n.timeout>0&&(s=setTimeout((function(){var t=Error("timeout");s=0,a.cancel(t),l(t)}),n.timeout))}));return i||(a.cancel=function(t){if(r){for(var e=r.length,n=1;n<e;n++)r[n](t);r[0](t),r=null}}),a}function g(t){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,h.call(this,t)}function y(t,e,n,i){if(!n)return[];var r,o,s,a,c,l,h,u=[],f=e.length,d=e[i],m=e[i+1];if(i===f&&n._listeners){if("function"==typeof n._listeners)return t&&t.push(n._listeners),[n];for(r=0,o=n._listeners.length;r<o;r++)t&&t.push(n._listeners[r]);return[n]}if("*"===d||"**"===d||n[d]){if("*"===d){for(s in n)"_listeners"!==s&&n.hasOwnProperty(s)&&(u=u.concat(y(t,e,n[s],i+1)));return u}if("**"===d){for(s in(h=i+1===f||i+2===f&&"*"===m)&&n._listeners&&(u=u.concat(y(t,e,n,f))),n)"_listeners"!==s&&n.hasOwnProperty(s)&&("*"===s||"**"===s?(n[s]._listeners&&!h&&(u=u.concat(y(t,e,n[s],f))),u=u.concat(y(t,e,n[s],i))):u=s===m?u.concat(y(t,e,n[s],i+2)):u.concat(y(t,e,n[s],i)));return u}u=u.concat(y(t,e,n[d],i+1))}if((a=n["*"])&&y(t,e,a,i+1),c=n["**"])if(i<f)for(s in c._listeners&&y(t,e,c,f),c)"_listeners"!==s&&c.hasOwnProperty(s)&&(s===m?y(t,e,c[s],i+2):s===d?y(t,e,c[s],i+1):((l={})[s]=c[s],y(t,e,{"**":l},i+1)));else c._listeners?y(t,e,c,f):c["*"]&&c["*"]._listeners&&y(t,e,c["*"],f);return u}function w(t,e){for(var n=0,i=(t="string"==typeof t?t.split(this.delimiter):t.slice()).length;n+1<i;n++)if("**"===t[n]&&"**"===t[n+1])return;for(var r=this.listenerTree,o=t.shift();void 0!==o;){if(r[o]||(r[o]={}),r=r[o],0===t.length)return r._listeners?("function"==typeof r._listeners&&(r._listeners=[r._listeners]),r._listeners.push(e),!r._listeners.warned&&this._maxListeners>0&&r._listeners.length>this._maxListeners&&(r._listeners.warned=!0,u.call(this,r._listeners.length,o))):r._listeners=e,!0;o=t.shift()}return!0}g.EventEmitter2=g,g.prototype.delimiter=".",g.prototype.setMaxListeners=function(t){void 0!==t&&(this._maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},g.prototype.getMaxListeners=function(){return this._maxListeners},g.prototype.event="",g.prototype.once=function(t,e){return this._once(t,e,!1)},g.prototype.prependOnceListener=function(t,e){return this._once(t,e,!0)},g.prototype._once=function(t,e,n){return this._many(t,1,e,n),this},g.prototype.many=function(t,e,n){return this._many(t,e,n,!1)},g.prototype.prependMany=function(t,e,n){return this._many(t,e,n,!0)},g.prototype._many=function(t,e,n,i){var r=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function o(){return 0==--e&&r.off(t,o),n.apply(this,arguments)}return o._origin=n,this._on(t,o,i),r},g.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||l.call(this);var t=arguments[0];if("newListener"===t&&!this._newListener&&!this._events.newListener)return!1;var e,n,i,r,o,s=arguments.length;if(this._all&&this._all.length){if(o=this._all.slice(),s>3)for(e=new Array(s),r=0;r<s;r++)e[r]=arguments[r];for(i=0,n=o.length;i<n;i++)switch(this.event=t,s){case 1:o[i].call(this,t);break;case 2:o[i].call(this,t,arguments[1]);break;case 3:o[i].call(this,t,arguments[1],arguments[2]);break;default:o[i].apply(this,e)}}if(this.wildcard){o=[];var a="string"==typeof t?t.split(this.delimiter):t.slice();y.call(this,o,a,this.listenerTree,0)}else{if("function"==typeof(o=this._events[t])){switch(this.event=t,s){case 1:o.call(this);break;case 2:o.call(this,arguments[1]);break;case 3:o.call(this,arguments[1],arguments[2]);break;default:for(e=new Array(s-1),r=1;r<s;r++)e[r-1]=arguments[r];o.apply(this,e)}return!0}o&&(o=o.slice())}if(o&&o.length){if(s>3)for(e=new Array(s-1),r=1;r<s;r++)e[r-1]=arguments[r];for(i=0,n=o.length;i<n;i++)switch(this.event=t,s){case 1:o[i].call(this);break;case 2:o[i].call(this,arguments[1]);break;case 3:o[i].call(this,arguments[1],arguments[2]);break;default:o[i].apply(this,e)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===t)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},g.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||l.call(this);var t=arguments[0];if("newListener"===t&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);var e,n,i,r,o,s=[],a=arguments.length;if(this._all){if(a>3)for(e=new Array(a),r=1;r<a;r++)e[r]=arguments[r];for(i=0,n=this._all.length;i<n;i++)switch(this.event=t,a){case 1:s.push(this._all[i].call(this,t));break;case 2:s.push(this._all[i].call(this,t,arguments[1]));break;case 3:s.push(this._all[i].call(this,t,arguments[1],arguments[2]));break;default:s.push(this._all[i].apply(this,e))}}if(this.wildcard){o=[];var c="string"==typeof t?t.split(this.delimiter):t.slice();y.call(this,o,c,this.listenerTree,0)}else o=this._events[t];if("function"==typeof o)switch(this.event=t,a){case 1:s.push(o.call(this));break;case 2:s.push(o.call(this,arguments[1]));break;case 3:s.push(o.call(this,arguments[1],arguments[2]));break;default:for(e=new Array(a-1),r=1;r<a;r++)e[r-1]=arguments[r];s.push(o.apply(this,e))}else if(o&&o.length){if(o=o.slice(),a>3)for(e=new Array(a-1),r=1;r<a;r++)e[r-1]=arguments[r];for(i=0,n=o.length;i<n;i++)switch(this.event=t,a){case 1:s.push(o[i].call(this));break;case 2:s.push(o[i].call(this,arguments[1]));break;case 3:s.push(o[i].call(this,arguments[1],arguments[2]));break;default:s.push(o[i].apply(this,e))}}else if(!this.ignoreErrors&&!this._all&&"error"===t)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(s)},g.prototype.on=function(t,e){return this._on(t,e,!1)},g.prototype.prependListener=function(t,e){return this._on(t,e,!0)},g.prototype.onAny=function(t){return this._onAny(t,!1)},g.prototype.prependAny=function(t){return this._onAny(t,!0)},g.prototype.addListener=g.prototype.on,g.prototype._onAny=function(t,e){if("function"!=typeof t)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),e?this._all.unshift(t):this._all.push(t),this},g.prototype._on=function(t,e,n){if("function"==typeof t)return this._onAny(t,e),this;if("function"!=typeof e)throw new Error("on only accepts instances of Function");return this._events||l.call(this),this._newListener&&this.emit("newListener",t,e),this.wildcard?(w.call(this,t,e),this):(this._events[t]?("function"==typeof this._events[t]&&(this._events[t]=[this._events[t]]),n?this._events[t].unshift(e):this._events[t].push(e),!this._events[t].warned&&this._maxListeners>0&&this._events[t].length>this._maxListeners&&(this._events[t].warned=!0,u.call(this,this._events[t].length,t))):this._events[t]=e,this)},g.prototype.off=function(t,e){if("function"!=typeof e)throw new Error("removeListener only takes instances of Function");var n,i=[];if(this.wildcard){var r="string"==typeof t?t.split(this.delimiter):t.slice();i=y.call(this,null,r,this.listenerTree,0)}else{if(!this._events[t])return this;n=this._events[t],i.push({_listeners:n})}for(var s=0;s<i.length;s++){var a=i[s];if(n=a._listeners,c(n)){for(var l=-1,h=0,u=n.length;h<u;h++)if(n[h]===e||n[h].listener&&n[h].listener===e||n[h]._origin&&n[h]._origin===e){l=h;break}if(l<0)continue;return this.wildcard?a._listeners.splice(l,1):this._events[t].splice(l,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[t]),this._removeListener&&this.emit("removeListener",t,e),this}(n===e||n.listener&&n.listener===e||n._origin&&n._origin===e)&&(this.wildcard?delete a._listeners:delete this._events[t],this._removeListener&&this.emit("removeListener",t,e))}return function t(e){if(void 0!==e){var n=Object.keys(e);for(var i in n){var r=n[i],s=e[r];s instanceof Function||"object"!==o(s)||null===s||(Object.keys(s).length>0&&t(e[r]),0===Object.keys(s).length&&delete e[r])}}}(this.listenerTree),this},g.prototype.offAny=function(t){var e,n=0,i=0;if(t&&this._all&&this._all.length>0){for(n=0,i=(e=this._all).length;n<i;n++)if(t===e[n])return e.splice(n,1),this._removeListener&&this.emit("removeListenerAny",t),this}else{if(e=this._all,this._removeListener)for(n=0,i=e.length;n<i;n++)this.emit("removeListenerAny",e[n]);this._all=[]}return this},g.prototype.removeListener=g.prototype.off,g.prototype.removeAllListeners=function(t){if(void 0===t)return!this._events||l.call(this),this;if(this.wildcard)for(var e="string"==typeof t?t.split(this.delimiter):t.slice(),n=y.call(this,null,e,this.listenerTree,0),i=0;i<n.length;i++){n[i]._listeners=null}else this._events&&(this._events[t]=null);return this},g.prototype.listeners=function(t){if(this.wildcard){var e=[],n="string"==typeof t?t.split(this.delimiter):t.slice();return y.call(this,e,n,this.listenerTree,0),e}return this._events||l.call(this),this._events[t]||(this._events[t]=[]),c(this._events[t])||(this._events[t]=[this._events[t]]),this._events[t]},g.prototype.eventNames=function(){return Object.keys(this._events)},g.prototype.listenerCount=function(t){return this.listeners(t).length},g.prototype.listenersAny=function(){return this._all?this._all:[]},g.prototype.waitFor=function(t,e){var n=this,i=o(e);return"number"===i?e={timeout:e}:"function"===i&&(e={filter:e}),v((e=d(e,{timeout:0,filter:void 0,handleError:!1,Promise:Promise,overload:!1},{filter:p,Promise:m})).Promise,(function(i,r,o){function s(){var t=e.filter;if(!t||t.apply(n,arguments))if(e.handleError){var o=arguments[0];o?r(o):i(f.apply(null,arguments).slice(1))}else i(f.apply(null,arguments))}o((function(){n.off(t,s)})),n._on(t,s,!1)}),{timeout:e.timeout,overload:e.overload})};var b=g.prototype;Object.defineProperties(g,{defaultMaxListeners:{get:function(){return b._maxListeners},set:function(t){if("number"!=typeof t||t<0||Number.isNaN(t))throw TypeError("n must be a non-negative number");b._maxListeners=t},enumerable:!0},once:{value:function(t,e,n){return v((n=d(n,{Promise:Promise,timeout:0,overload:!1},{Promise:m})).Promise,(function(n,i,r){var o;if("function"==typeof t.addEventListener)return o=function(){n(f.apply(null,arguments))},r((function(){t.removeEventListener(e,o)})),void t.addEventListener(e,o,{once:!0});var s,a=function(){s&&t.removeListener("error",s),n(f.apply(null,arguments))};"error"!==e&&(s=function(n){t.removeListener(e,a),i(n)},t.once("error",s)),r((function(){s&&t.removeListener("error",s),t.removeListener(e,a)})),t.once(e,a)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(b,{_maxListeners:{value:10,writable:!0,configurable:!0}}),void 0===(r=function(){return g}.call(e,n,e,t))||(t.exports=r)}()}).call(this,n(9))},function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty;function r(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}e.stringify=function(t,e){e=e||"";var n,r,o=[];for(r in"string"!=typeof e&&(e="?"),t)if(i.call(t,r)){if((n=t[r])||null!=n&&!isNaN(n)||(n=""),r=encodeURIComponent(r),n=encodeURIComponent(n),null===r||null===n)continue;o.push(r+"="+n)}return o.length?e+o.join("&"):""},e.parse=function(t){for(var e,n=/([^=?&]+)=?([^&]*)/g,i={};e=n.exec(t);){var o=r(e[1]),s=r(e[2]);null===o||null===s||o in i||(i[o]=s)}return i}},function(t,e,n){var i,r;void 0===(r="function"==typeof(i=function(){var t={},e=function(t){var e=document.createEvent("Event");e.initEvent("pym:"+t,!0,!0),document.dispatchEvent(e)},n=function(t){var e=new RegExp("[\\?&]"+t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)").exec(location.search);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},i=function(t,e){if(("*"===e.xdomain||t.origin.match(new RegExp(e.xdomain+"$")))&&"string"==typeof t.data)return!0},r=function(t,e,n){return["pym",t,e,n].join("xPYMx")},o=Date.now||function(){return(new Date).getTime()},s=function(){for(var e=t.autoInitInstances.length-1;e>=0;e--){var n=t.autoInitInstances[e];n.el.getElementsByTagName("iframe").length&&n.el.getElementsByTagName("iframe")[0].contentWindow||t.autoInitInstances.splice(e,1)}};return t.autoInitInstances=[],t.autoInit=function(n){var i=document.querySelectorAll("[data-pym-src]:not([data-pym-auto-initialized])"),r=i.length;s();for(var o=0;o<r;++o){var a=i[o];a.setAttribute("data-pym-auto-initialized",""),""===a.id&&(a.id="pym-"+o+"-"+Math.random().toString(36).substr(2,5));var c=a.getAttribute("data-pym-src"),l={xdomain:"string",title:"string",name:"string",id:"string",sandbox:"string",allowfullscreen:"boolean",parenturlparam:"string",parenturlvalue:"string",optionalparams:"boolean",trackscroll:"boolean",scrollwait:"number"},h={};for(var u in l)if(null!==a.getAttribute("data-pym-"+u))switch(l[u]){case"boolean":h[u]=!("false"===a.getAttribute("data-pym-"+u));break;case"string":h[u]=a.getAttribute("data-pym-"+u);break;case"number":var f=Number(a.getAttribute("data-pym-"+u));isNaN(f)||(h[u]=f);break;default:console.err("unrecognized attribute type")}var d=new t.Parent(a.id,c,h);t.autoInitInstances.push(d)}return n||e("pym-initialized"),t.autoInitInstances},t.Parent=function(t,e,n){for(var a in this.id=t,this.url=e,this.el=document.getElementById(t),this.iframe=null,this.settings={xdomain:"*",optionalparams:!0,parenturlparam:"parentUrl",parenturlvalue:window.location.href,trackscroll:!1,scrollwait:100},this.messageRegex=function(t){return new RegExp("^"+["pym",t,"(\\S+)","(.*)"].join("xPYMx")+"$")}(this.id),this.messageHandlers={},n=n||{},this._constructIframe=function(){var t=this.el.offsetWidth.toString();this.iframe=document.createElement("iframe");var e="",n=this.url.indexOf("#");for(n>-1&&(e=this.url.substring(n,this.url.length),this.url=this.url.substring(0,n)),this.url.indexOf("?")<0?this.url+="?":this.url+="&",this.iframe.src=this.url+"initialWidth="+t+"&childId="+this.id,this.settings.optionalparams&&(this.iframe.src+="&parentTitle="+encodeURIComponent(document.title),this.iframe.src+="&"+this.settings.parenturlparam+"="+encodeURIComponent(this.settings.parenturlvalue)),this.iframe.src+=e,this.iframe.setAttribute("width","100%"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("frameborder","0"),this.settings.title&&this.iframe.setAttribute("title",this.settings.title),void 0!==this.settings.allowfullscreen&&!1!==this.settings.allowfullscreen&&this.iframe.setAttribute("allowfullscreen",""),void 0!==this.settings.sandbox&&"string"==typeof this.settings.sandbox&&this.iframe.setAttribute("sandbox",this.settings.sandbox),this.settings.id&&(document.getElementById(this.settings.id)||this.iframe.setAttribute("id",this.settings.id)),this.settings.name&&this.iframe.setAttribute("name",this.settings.name);this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.appendChild(this.iframe),window.addEventListener("resize",this._onResize),this.settings.trackscroll&&window.addEventListener("scroll",this._throttleOnScroll)},this._onResize=function(){this.sendWidth(),this.settings.trackscroll&&this.sendViewportAndIFramePosition()}.bind(this),this._onScroll=function(){this.sendViewportAndIFramePosition()}.bind(this),this._fire=function(t,e){if(t in this.messageHandlers)for(var n=0;n<this.messageHandlers[t].length;n++)this.messageHandlers[t][n].call(this,e)},this.remove=function(){window.removeEventListener("message",this._processMessage),window.removeEventListener("resize",this._onResize),this.el.removeChild(this.iframe),s()},this._processMessage=function(t){if(i(t,this.settings)&&"string"==typeof t.data){var e=t.data.match(this.messageRegex);if(!e||3!==e.length)return!1;var n=e[1],r=e[2];this._fire(n,r)}}.bind(this),this._onHeightMessage=function(t){var e=parseInt(t);this.iframe.setAttribute("height",e+"px")},this._onNavigateToMessage=function(t){(function(t){if(t.match(/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/gi))return!0})(t)&&(document.location.href=t)},this._onScrollToChildPosMessage=function(t){var e=document.getElementById(this.id).getBoundingClientRect().top+window.pageYOffset+parseInt(t);window.scrollTo(0,e)},this.onMessage=function(t,e){t in this.messageHandlers||(this.messageHandlers[t]=[]),this.messageHandlers[t].push(e)},this.sendMessage=function(t,e){this.el.getElementsByTagName("iframe").length&&(this.el.getElementsByTagName("iframe")[0].contentWindow?this.el.getElementsByTagName("iframe")[0].contentWindow.postMessage(r(this.id,t,e),"*"):this.remove())},this.sendWidth=function(){var t=this.el.offsetWidth.toString();this.sendMessage("width",t)},this.sendViewportAndIFramePosition=function(){var t=this.iframe.getBoundingClientRect(),e=(window.innerWidth||document.documentElement.clientWidth)+" "+(window.innerHeight||document.documentElement.clientHeight);e+=" "+t.top+" "+t.left,e+=" "+t.bottom+" "+t.right,this.sendMessage("viewport-iframe-position",e)},n)this.settings[a]=n[a];return this._throttleOnScroll=function(t,e,n){var i,r,s,a=null,c=0;n||(n={});var l=function(){c=!1===n.leading?0:o(),a=null,s=t.apply(i,r),a||(i=r=null)};return function(){var h=o();c||!1!==n.leading||(c=h);var u=e-(h-c);return i=this,r=arguments,u<=0||u>e?(a&&(clearTimeout(a),a=null),c=h,s=t.apply(i,r),a||(i=r=null)):a||!1===n.trailing||(a=setTimeout(l,u)),s}}(this._onScroll.bind(this),this.settings.scrollwait),this.onMessage("height",this._onHeightMessage),this.onMessage("navigateTo",this._onNavigateToMessage),this.onMessage("scrollToChildPos",this._onScrollToChildPosMessage),this.onMessage("parentPositionInfo",this.sendViewportAndIFramePosition),window.addEventListener("message",this._processMessage,!1),this._constructIframe(),this},t.Child=function(t){for(var o in this.parentWidth=null,this.id=null,this.parentTitle=null,this.parentUrl=null,this.settings={renderCallback:null,xdomain:"*",polling:0,parenturlparam:"parentUrl"},this.timerId=null,this.messageRegex=null,this.messageHandlers={},t=t||{},this.onMessage=function(t,e){t in this.messageHandlers||(this.messageHandlers[t]=[]),this.messageHandlers[t].push(e)},this._fire=function(t,e){if(t in this.messageHandlers)for(var n=0;n<this.messageHandlers[t].length;n++)this.messageHandlers[t][n].call(this,e)},this._processMessage=function(t){if(i(t,this.settings)&&"string"==typeof t.data){var e=t.data.match(this.messageRegex);if(e&&3===e.length){var n=e[1],r=e[2];this._fire(n,r)}}}.bind(this),this._onWidthMessage=function(t){var e=parseInt(t);e!==this.parentWidth&&(this.parentWidth=e,this.settings.renderCallback&&this.settings.renderCallback(e),this.sendHeight())},this.sendMessage=function(t,e){window.parent.postMessage(r(this.id,t,e),"*")},this.sendHeight=function(){var t=document.getElementsByTagName("body")[0].offsetHeight.toString();return this.sendMessage("height",t),t}.bind(this),this.getParentPositionInfo=function(){this.sendMessage("parentPositionInfo")},this.scrollParentTo=function(t){this.sendMessage("navigateTo","#"+t)},this.navigateParentTo=function(t){this.sendMessage("navigateTo",t)},this.scrollParentToChildEl=function(t){var e=document.getElementById(t).getBoundingClientRect().top+window.pageYOffset;this.scrollParentToChildPos(e)},this.scrollParentToChildPos=function(t){this.sendMessage("scrollToChildPos",t.toString())},this.remove=function(){window.removeEventListener("message",this._processMessage),this.timerId&&clearInterval(this.timerId)},t)this.settings[o]=t[o];this.id=n("childId")||t.id,this.messageRegex=new RegExp("^pymxPYMx"+this.id+"xPYMx(\\S+)xPYMx(.*)$");var s=parseInt(n("initialWidth"));return this.parentUrl=n(this.settings.parenturlparam),this.parentTitle=n("parentTitle"),this.onMessage("width",this._onWidthMessage),window.addEventListener("message",this._processMessage,!1),this.settings.renderCallback&&this.settings.renderCallback(s),this.sendHeight(),this.settings.polling&&(this.timerId=window.setInterval(this.sendHeight,this.settings.polling)),function(t){var n,i=document.getElementsByTagName("html")[0],r=i.className;try{n=window.self!==window.top?"embedded":"not-embedded"}catch(o){n="embedded"}r.indexOf(n)<0&&(i.className=r?r+" "+n:n,t&&t(n),e("marked-embedded"))}(t.onMarkedEmbeddedStatus),this},"undefined"!=typeof document&&t.autoInit(!0),t})?i.call(e,n,e,t):i)||(t.exports=r)},,,,function(t,e,n){t.exports=n(10)},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){"use strict";if("object"===("undefined"==typeof window?"undefined":n(window)))if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var t=window.document,e=[];r.prototype.THROTTLE_TIMEOUT=100,r.prototype.POLL_INTERVAL=null,r.prototype.USE_MUTATION_OBSERVER=!0,r.prototype.observe=function(t){if(!this._observationTargets.some((function(e){return e.element==t}))){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},r.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter((function(e){return e.element!=t})),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},r.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},r.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},r.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter((function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]}))},r.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map((function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}}));return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},r.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(o(window,"resize",this._checkForIntersections,!0),o(t,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},r.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,s(window,"resize",this._checkForIntersections,!0),s(t,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},r.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(n){var r=n.element,o=a(r),s=this._rootContainsTarget(r),c=n.entry,l=t&&s&&this._computeTargetAndRootIntersection(r,e),h=n.entry=new i({time:window.performance&&performance.now&&performance.now(),target:r,boundingClientRect:o,rootBounds:e,intersectionRect:l});c?t&&s?this._hasCrossedThreshold(c,h)&&this._queuedEntries.push(h):c&&c.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},r.prototype._computeTargetAndRootIntersection=function(e,n){if("none"!=window.getComputedStyle(e).display){for(var i,r,o,s,c,h,u,f,d=a(e),m=l(e),p=!1;!p;){var v=null,g=1==m.nodeType?window.getComputedStyle(m):{};if("none"==g.display)return;if(m==this.root||m==t?(p=!0,v=n):m!=t.body&&m!=t.documentElement&&"visible"!=g.overflow&&(v=a(m)),v&&(i=v,r=d,o=void 0,s=void 0,c=void 0,h=void 0,u=void 0,f=void 0,o=Math.max(i.top,r.top),s=Math.min(i.bottom,r.bottom),c=Math.max(i.left,r.left),h=Math.min(i.right,r.right),f=s-o,!(d=(u=h-c)>=0&&f>=0&&{top:o,bottom:s,left:c,right:h,width:u,height:f})))break;m=l(m)}return d}},r.prototype._getRootRect=function(){var e;if(this.root)e=a(this.root);else{var n=t.documentElement,i=t.body;e={top:0,left:0,right:n.clientWidth||i.clientWidth,width:n.clientWidth||i.clientWidth,bottom:n.clientHeight||i.clientHeight,height:n.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(e)},r.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map((function(e,n){return"px"==e.unit?e.value:e.value*(n%2?t.width:t.height)/100})),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},r.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,i=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==i)for(var r=0;r<this.thresholds.length;r++){var o=this.thresholds[r];if(o==n||o==i||o<n!=o<i)return!0}},r.prototype._rootIsInDom=function(){return!this.root||c(t,this.root)},r.prototype._rootContainsTarget=function(e){return c(this.root||t,e)},r.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},r.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},window.IntersectionObserver=r,window.IntersectionObserverEntry=i}function i(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,i=this.intersectionRect,r=i.width*i.height;this.intersectionRatio=n?Number((r/n).toFixed(4)):this.isIntersecting?1:0}function r(t,e){var n,i,r,o=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(o.root&&1!=o.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),i=this.THROTTLE_TIMEOUT,r=null,function(){r||(r=setTimeout((function(){n(),r=null}),i))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(o.rootMargin),this.thresholds=this._initThresholds(o.threshold),this.root=o.root||null,this.rootMargin=this._rootMarginValues.map((function(t){return t.value+t.unit})).join(" ")}function o(t,e,n,i){"function"==typeof t.addEventListener?t.addEventListener(e,n,i||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function s(t,e,n,i){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,i||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function a(t){var e;try{e=t.getBoundingClientRect()}catch(n){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function c(t,e){for(var n=e;n;){if(n==t)return!0;n=l(n)}return!1}function l(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e&&e.assignedSlot?e.assignedSlot.parentNode:e}}()},function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var c,l=[],h=!1,u=-1;function f(){h&&c&&(h=!1,c.length?l=c.concat(l):u=-1,l.length&&d())}function d(){if(!h){var t=a(f);h=!0;for(var e=l.length;e;){for(c=l,l=[];++u<e;)c&&c[u].run();u=-1,e=l.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new m(t,e)),1!==l.length||h||a(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";n.r(e),n.d(e,"createStreamEmbed",(function(){return B}));n(8);var i=n(1),r=n(2),o=n.n(r);function s(){return location.origin||"".concat(window.location.protocol,"//").concat(window.location.host)}var a=function(){var t=document.querySelector('link[rel="canonical"]');return t?t.href:(console.warn("This page does not include a canonical link tag. Coral has inferred this story_url from the window object. Query params have been stripped, which may cause a single thread to be present across multiple pages."),s()+window.location.pathname)};function c(t,e){var n={};return Object.keys(t).forEach((function(e){void 0!==t[e]&&(n[e]=t[e])})),o.a.stringify(n,e)}function l(t){return t.replace(/\/$/,"")}var h={stream:"/embed/stream",auth:"/embed/auth",deleteAccount:"/embed/deleteAccount"},u=function(t){t.el.firstChild.style.width="1px",t.el.firstChild.style.minWidth="100%"},f=function(t){return function(e){var n;e.onMessage("height",(function(i){if(i!==n){n=i;var r=parseInt(i,10);e.iframe.style.height="".concat(r,"px"),t&&window.parent.postMessage({sentinel:"amp",type:"embed-size",height:r>100?r:100},"*")}}))}},d=function(t){var e=function(){return t.sendMessage("click","")};return document.addEventListener("click",e,!0),function(){document.removeEventListener("click",e,!0)}};function m(t,e,n){return t.substr(!n||n<0?0:+n,e.length)===e}var p=function(t){t.onMessage("setCommentID",(function(t){var e=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.protocol,n=void 0===e?window.location.protocol:e,i=t.hostname,r=void 0===i?window.location.hostname:i,o=t.port,s=void 0===o?window.location.port:o,a=t.pathname,c=void 0===a?window.location.pathname:a,l=t.search,h=void 0===l?window.location.search:l,u=t.hash,f=void 0===u?window.location.hash:u;return h&&!m(h,"?")?h="?".concat(h):"?"===h&&(h=""),m(c,"/")||(c="/"+c),"".concat(n,"//").concat(r).concat(s?":".concat(s):"").concat(c).concat(h).concat(f)}({search:c(Object.assign(Object.assign({},Object(r.parse)(location.search)),{commentID:t||void 0}))});window.history.pushState({},document.title,e)}));var e=function(e){var n=Object(r.parse)(location.search).commentID;t.sendMessage("setCommentID",n||"")};return window.addEventListener("popstate",e),function(){window.removeEventListener("popstate",e)}},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){n.onMessage("event",(function(n){var i=JSON.parse(n),r=i.eventName,o=i.value;if(!e){if(m(r,"mutation."))return;if(m(r,"fetch."))return;if(m(r,"subscription."))return}t.emit(r,o)})),n.onMessage("ready",(function(){t.emit("ready")}))}},g=function(t){return function(){t.on("commentCount",(function(t){document.querySelectorAll("".concat(".coral-count","[data-coral-url='").concat(t.storyURL,"'], ").concat(".coral-count","[data-coral-id='").concat(t.storyID,"']")).forEach((function(e){e.querySelectorAll(".coral-count-number").forEach((function(e){e.innerHTML=t.number})),e.querySelectorAll(".coral-count-text").forEach((function(e){e.innerHTML=t.text}))}))}))}};function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var b=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(this,t),this.data=e}var e,n,i;return e=t,(n=[{key:"clear",value:function(){this.data={}}},{key:"key",value:function(t){return this.length<=t?null:Object.keys(this.data)[t]}},{key:"getItem",value:function(t){return this.data[t]||null}},{key:"setItem",value:function(t,e){this.data[t]=e}},{key:"removeItem",value:function(t){delete this.data[t]}},{key:"toString",value:function(){return JSON.stringify(this.data)}},{key:"length",get:function(){return Object.keys(this.data).length}}])&&w(e.prototype,n),i&&w(e,i),t}();function _(t){return new b(t)}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var I=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=e,this.prefix=n}var e,n,i;return e=t,(n=[{key:"clear",value:function(){for(var t=this,e=[],n=0;n<this.storage.length;n++){var i=this.storage.key(n);m(i,this.prefix)&&e.push(i)}e.forEach((function(e){return t.storage.removeItem(e)}))}},{key:"key",value:function(t){for(var e=0,n=0;n<this.storage.length;n++){var i=this.storage.key(n);if(m(i,this.prefix)){if(e===t)return i;e++}}return null}},{key:"getItem",value:function(t){return this.storage.getItem("".concat(this.prefix).concat(t))}},{key:"setItem",value:function(t,e){return this.storage.setItem("".concat(this.prefix).concat(t),e)}},{key:"removeItem",value:function(t){return this.storage.removeItem("".concat(this.prefix).concat(t))}},{key:"length",get:function(){for(var t=0,e=0;e<this.storage.length;e++)m(this.storage.key(e),this.prefix)&&t++;return t}}])&&E(e.prototype,n),i&&E(e,i),t}();function k(t,e){return new I(t,e)}var T=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"coral:";return function(i){var r=t?k(t,n):_();i.onMessage("pymStorage.".concat(e,".request"),(function(t){var n,o=JSON.parse(t),s=o.id,a=o.method,c=o.parameters,l=c.n,h=c.key,u=c.value,f=function(t){console.error(t),i.sendMessage("pymStorage.".concat(e,".error"),JSON.stringify({id:s,error:t}))};try{switch(a){case"setItem":n=r.setItem(h,u);break;case"getItem":n=r.getItem(h);break;case"removeItem":n=r.removeItem(h);break;case"key":n=r.key(l);break;case"length":n=r.length;break;case"clear":n=r.clear();break;default:return void f("Unknown method ".concat(a))}}catch(d){return void f(d.toString())}i.sendMessage("pymStorage.".concat(e,".response"),JSON.stringify({id:s,result:n}))}))}},L=function(t){return function(e){e.onMessage("getConfig",(function(){e.sendMessage("config",JSON.stringify(t))}))}},M=function(t){var e=function(e){var n={key:e.key,shiftKey:e.shiftKey};t.sendMessage("keypress",JSON.stringify(n))};return document.addEventListener("keypress",e),function(){document.removeEventListener("keypress",e)}},x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e){e.onMessage("getRefreshAccessToken",(function(){if(t){var n=!1;t((function(t){if(n)throw new Error("next access token has been already provided");n=!0,e.sendMessage("refreshAccessToken",t)}))}else e.sendMessage("refreshAccessToken","")}))}};var R=function(){return void 0!==window.CoralCount},O=function(t){if(!R()&&document.querySelector(".coral-count")){var e=document.createElement("script");e.src="".concat(t,"/assets/js/count.js"),e.className="coral-script",e.async=!1,e.defer=!0,(document.head||document.body).appendChild(e)}};function A(t,e){var n=new IntersectionObserver((function(t){t[0].isIntersecting&&(n.disconnect(),e())}),{rootMargin:"100px",threshold:1});return n.observe(t),function(){return n.disconnect()}}var S=n(3),C=n.n(S);function P(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var N=function(t){return new j(t)},j=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rendered=!1,this.id=e.id,this.url=e.url,this.title=e.title,this.decorators=e.decorators}var e,n,i;return e=t,(n=[{key:"render",value:function(){if(!this.rendered){var t=new C.a.Parent(this.id,this.url,{title:this.title,id:"".concat(this.id,"_iframe"),name:"".concat(this.id,"_iframe")}),e=this.decorators.map((function(e){return e(t)})).filter((function(t){return!!t}));this.rendered=!0,this.parent=t,this.cleanups=e}}},{key:"sendMessage",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!this.rendered||!this.parent)throw new Error("not mounted");this.parent.sendMessage(t,e)}},{key:"remove",value:function(){if(!this.rendered||!this.parent||!this.cleanups)throw new Error("not mounted");this.cleanups.forEach((function(t){return t()})),this.cleanups=null,this.parent.remove(),this.parent=null,this.rendered=!1}}])&&P(e.prototype,n),i&&P(e,i),t}();var U=function(t){var e;try{e=window[t]}catch(n){console.debug("".concat(t," not available, use in-memory replacement")),e=_()}return e};function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var W=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:N;H(this,t),this.requestExpiryInterval=9e5,this.ready=!1,this.clearAutoRender=null;var r=document.getElementById(e.id);if(!r)throw new Error("element ".concat(e.id," was not found"));this.eventEmitter=e.eventEmitter,e.eventEmitter.once("ready",(function(){n.ready=!0}));var o=[u,f(!!e.amp),d,p,v(e.eventEmitter,e.enableDeprecatedEvents),g(e.eventEmitter),T(U("localStorage"),"localStorage"),T(U("sessionStorage"),"sessionStorage"),L({accessToken:e.accessToken,bodyClassName:e.bodyClassName}),M,x(e.refreshAccessToken)],s=c({storyID:e.storyID,storyURL:e.storyURL,storyMode:e.storyMode,commentID:e.commentID,customCSSURL:e.customCSSURL,v:"6.6.2",ts:Math.round(Date.now()/this.requestExpiryInterval)*this.requestExpiryInterval}),a=l(e.rootURL)+h.stream,m="".concat(a,"?").concat(s);this.control=i({id:e.id,title:e.title,decorators:o,url:m}),O(e.rootURL),e.commentID&&setTimeout((function(){return e.eventEmitter.emit("showPermalink")}),0),e.autoRender&&(e.commentID?this.render():this.clearAutoRender=A(r,(function(){n.clearAutoRender=null,n.render()})))}var e,n,i;return e=t,(n=[{key:"on",value:function(t,e){return this.eventEmitter.on(t,e)}},{key:"off",value:function(t,e){return this.eventEmitter.off(t,e)}},{key:"login",value:function(t){var e=this;this.ready?this.control.sendMessage("login",t):this.eventEmitter.once("ready",(function(){e.control.sendMessage("login",t)}))}},{key:"logout",value:function(){var t=this;this.ready?this.control.sendMessage("logout"):this.eventEmitter.once("ready",(function(){t.control.sendMessage("logout")}))}},{key:"remove",value:function(){if(this.clearAutoRender)return this.clearAutoRender(),void(this.clearAutoRender=null);if(!this.control.rendered)throw new Error("instance not mounted");this.control.remove()}},{key:"render",value:function(){this.control.rendered||this.control.render()}},{key:"rendered",get:function(){return this.control.rendered}}])&&D(e.prototype,n),i&&D(e,i),t}();function B(t){var e=Object(r.parse)(location.search),n=new i.EventEmitter2({wildcard:!0});return t.events&&t.events(n),new W({title:"Coral Embed Stream",storyID:t.storyID||e.storyID,storyURL:t.storyURL||e.storyURL||a(),storyMode:t.storyMode||void 0,commentID:t.commentID||e.commentID,id:t.id||"coral-embed-stream",rootURL:t.rootURL||s(),autoRender:t.autoRender,eventEmitter:n,accessToken:t.accessToken,bodyClassName:t.bodyClassName,enableDeprecatedEvents:t.enableDeprecatedEvents,customCSSURL:t.customCSSURL,refreshAccessToken:t.refreshAccessToken,amp:t.amp})}"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(t,e){e=e||window;for(var n=0;n<this.length;n++)t.call(e,this[n],n,this)})}]);
//# sourceMappingURL=embed.js.map